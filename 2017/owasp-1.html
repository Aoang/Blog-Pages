<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="//946771200.xyz"><link rel="dns-prefetch" href="//cdn.jsdelivr.net"><link rel="dns-prefetch" href="//www.googletagmanager.com"><link rel="dns-prefetch" href="//www.google-analytics.com"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=5,viewport-fit=cover"><meta name="renderer" content="webkit"><title>OWASP Top 10 - Injection | Aoang&#39;s Blog</title><link rel="icon" type="image&#x2F;ico" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/apple-touch-icon.png"><link rel="icon" typt="image&#x2F;png" sizes="192x192" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/android-chrome-192x192.png"><link rel="icon" typt="image&#x2F;png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/favicon-32x32.png"><link rel="icon" typt="image&#x2F;png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/favicon-16x16.png"><link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/safari-pinned-tab.svg" color=""><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/spectre.css@latest"><style>body{background-color:#f8f9fa}a,a:visited{color:#0070ff}a:active,a:focus,a:hover{color:#0070ff;opacity:.75}#post-content a,#post-content a:focus,#post-content a:hover,#post-content a:visited{color:#005eb9;opacity:1}.post-entry .card-body a{color:#0070ff}.avatar{background:#444}.navbar-link,.navbar-link:visited,.timeline .timeline-item .timeline-icon.icon-lg{color:#0070ff}.navbar-link:hover{color:#0070ff;opacity:.8}#disqus-loadmore-button,#disqus-switch-to-direct,#disqus_click_btn,#search-input .btn{background:#727e96;border-color:#727e96;color:#fff}#post-toc a.post-toc-link,#post-toc a.post-toc-link:visited,.share-menu.menu .menu-item>a{color:#727e96}.share-menu.menu .menu-item>a:focus,.share-menu.menu .menu-item>a:hover,.share-menu.menu .menu-item>a:visited{color:#50596c;background:#f8f9fa;opacity:.85}</style><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/css/highlight/github.min.css" as="style" onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel="stylesheet" href="/css/highlight/github.min.css"></noscript><script>!function(n){"use strict";n.loadCSS||(n.loadCSS=function(){});var o=loadCSS.relpreload={};if(o.support=function(){var e;try{e=n.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),o.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},o.poly=function(){if(!o.support())for(var t=n.document.getElementsByTagName("link"),e=0;e<t.length;e++){var a=t[e];"preload"!==a.rel||"style"!==a.getAttribute("as")||a.getAttribute("data-loadcss")||(a.setAttribute("data-loadcss",!0),o.bindMediaToggle(a))}},!o.support()){o.poly();var t=n.setInterval(o.poly,500);n.addEventListener?n.addEventListener("load",function(){o.poly(),n.clearInterval(t)}):n.attachEvent&&n.attachEvent("onload",function(){o.poly(),n.clearInterval(t)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:n.loadCSS=loadCSS}("undefined"!=typeof global?global:this)</script><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="Aoang's Blog"><meta name="msapplication-starturl" content="https://01.946771200.xyz"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Aoang's Blog"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="manifest" href="/manifest.json"><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Aoang's Blog"><meta property="og:title" content="OWASP Top 10 - Injection | Aoang&#39;s Blog"><meta property="og:site_name" content="Aoang&#39;s Blog"><meta property="og:type" content="article"><meta property="og:url" content="https:&#x2F;&#x2F;01.946771200.xyz&#x2F;2017&#x2F;owasp-1.html"><meta property="og:locale" content="zh-CN"><meta name="description" content="在应用程序安全性中，如果不处理用户输入及其相关数据，可能会带来安全风险。而注入是使用最广泛，以及最古老和非常危险的漏洞之一，在 OWASP Top 10 从 2010 开始一直到现在都是第一，还是挺有趣的。 注入是将不受信任的数据作为命令或查询的一部分发送到解析器时，会产生诸如SQL注入、NoSQL注入、OS注入和LDAP注入的注入缺陷。攻击者的恶意数据可以诱使解析器在没有适当授权的情况下执行非预 - Aoang - Aoang&#39;s Blog"><meta name="keywords" content="OWASP, Injection, 网络安全, 注入, Aoang, Aoangc, Blog, 博客, 网络, 安全"><meta property="article:published_time" content="2017-03-16T14:49:28.000Z"><meta property="article:modified_time" content="2019-09-20T08:49:28.000Z"><meta property="og:updated_time" content="2019-09-20T08:49:28.000Z"><meta property="article:author" content="Aoang"><meta property="article:tag" content="OWASP, Injection, 网络安全, 注入, Aoang, Aoangc, Blog, 博客, 网络, 安全"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://01.946771200.xyz/2017/owasp-1.html"><meta name="generator" content="Hexo 4.0.0"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-130715850-2"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-130715850-2")</script><script type="application/ld+json">{
    "@context": "http://schema.org",
    "url": "https://01.946771200.xyz/2017/owasp-1.html",
    "@type": "BlogPosting",
    "logo": "https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/android-chrome-192x192.png",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://01.946771200.xyz/2017/owasp-1.html"
    },
    "headline": "OWASP Top 10 - Injection | Aoang&#39;s Blog",
    
    "image": {
        "@type": "ImageObject",
        "url": "https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/android-chrome-192x192.png"
    },
    
    "datePublished": "2017-03-16T14:49:28.000Z",
    "dateModified": "2019-09-20T08:49:28.000Z",
    "author": {
        "@type": "Person",
        "name": "Aoang",
        "image": {
            "@type": "ImageObject",
            "url": "https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/img.png"
        },
        "description": "岁月在电波中流淌，人生在音乐中升华"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Aoang&#39;s Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/android-chrome-192x192.png"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "https://01.946771200.xyz/search.html?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": "OWASP, Injection, 网络安全, 注入, Aoang, Aoangc, Blog, 博客, 网络, 安全",
    "description": "在应用程序安全性中，如果不处理用户输入及其相关数据，可能会带来安全风险。而注入是使用最广泛，以及最古老和非常危险的漏洞之一，在 OWASP Top 10 从 2010 开始一直到现在都是第一，还是挺有趣的。 注入是将不受信任的数据作为命令或查询的一部分发送到解析器时，会产生诸如SQL注入、NoSQL注入、OS注入和LDAP注入的注入缺陷。攻击者的恶意数据可以诱使解析器在没有适当授权的情况下执行非预 - Aoang - Aoang&#39;s Blog"
}</script><link rel="alternate" href="/atom.xml" title="Aoang's Blog" type="application/atom+xml"></head><body><header><h1 class="header-title text-center"><a href="/">Aoang&#39;s Blog</a></h1><p class="text-center header-slogan">岁月在电波中流淌，人生在音乐中升华</p><nav class="navbar-section text-center"><a href="/" class="navbar-link">首页</a> <a href="/archives/" class="navbar-link">归档</a> <a href="/search.html" class="navbar-link">搜索</a> <a href="/project.html" class="navbar-link">项目</a> <a href="/wiki/" class="navbar-link">文档</a> <a href="/links.html" class="navbar-link">友链</a> <a href="/about.html" class="navbar-link">关于</a></nav></header><div class="post-container"><div id="post-card" class="card"><div class="card-item-container"><div class="card-inner-cell"><div class="card-header"><h1 class="card-title h3 mb-2">OWASP Top 10 - Injection</h1><div class="post-header-info"><p class="post-header-info-left text-gray"><img class="author-thumb lazyload" data-src="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/img.png" src="/img/suka-lazyload.gif" alt="Aoang's Avatar"> <span>2017-03-16</span></p><div class="post-header-info-right"></div></div></div><div class="card-body"><div id="post-toc"><ol class="post-toc"><li class="post-toc-item post-toc-level-6"><a class="post-toc-link" href="#如何确保数据的有效性？"><span class="post-toc-number">1.</span> <span class="post-toc-text">如何确保数据的有效性？</span></a></li><li class="post-toc-item post-toc-level-6"><a class="post-toc-link" href="#数据完整性"><span class="post-toc-number">2.</span> <span class="post-toc-text">数据完整性</span></a></li><li class="post-toc-item post-toc-level-6"><a class="post-toc-link" href="#消毒是指删除、替换数据。"><span class="post-toc-number">3.</span> <span class="post-toc-text">消毒是指删除、替换数据。</span></a></li></ol></div><article id="post-content"><p>在应用程序安全性中，如果不处理用户输入及其相关数据，可能会带来安全风险。<br>而注入是使用最广泛，以及最古老和非常危险的漏洞之一，在 OWASP Top 10 从 2010 开始一直到现在都是第一，还是挺有趣的。</p><p>注入是将不受信任的数据作为命令或查询的一部分发送到解析器时，会产生诸如SQL注入、NoSQL注入、OS注入和LDAP注入的注入缺陷。<br>攻击者的恶意数据可以诱使解析器在没有适当授权的情况下执行非预期命令或访问数据。</p><p>例如，我们需要查询用户输入的用户名和密码是否对应。</p><p><code>SELECT * FROM Users WHERE username= $username AND password= $password;</code></p><p>如果未经处理用户的输入，当用户的输入中存在<code>’--</code> 或者 <code>‘ or ‘1’=’1</code>，那可能不仅仅只是代码没有进行预期的工作，还可能泄露信息。</p><p>一般情况下，我们使用验证和清理来解决这些问题。<br>这些验证应根据服务器的功能在应用程序的每一层中执行。<br>要说明是，所有数据验证过程都必须在受信系统（服务器）上完成。</p><p>当应用程序处理用户数据时，默认情况下必须将提交的数据视为不安全，并且只有在进行了适当的安全检查后才可以接受。<br>还必须将数据源标识为可信或不可信，如果是不可信源，则必须进行验证检查。</p><p>在验证检查中，将根据一组条件检查用户输入，以确保用户确实输入了期望的数据。<br>如果验证失败，则拒绝输入。<br>这不仅从安全角度来看很重要，而且从数据一致性和完整性的角度来看也很重要，因为数据通常在各种系统和应用程序中使用。</p><p>Golang 标准库中其实有了很多可以用于检查输入的包，strconv 类型转换、strings 字符串处理、regexp 正则等。</p><h6 id="如何确保数据的有效性？"><a href="#如何确保数据的有效性？" class="headerlink" title="如何确保数据的有效性？"></a>如何确保数据的有效性？</h6><ol><li>白名单机制，尽可能根据白名单来验证输入</li><li>边界检查，数据长度均应进行验证</li><li>字符转义，用于特殊字符，例如独立的引号</li><li>数值验证</li><li>空字节</li><li>换行符</li><li>路径变更字符 <code>../ \\..</code></li><li>UTF-8 字符替代表示</li></ol><p>完成了这些检查，我们就能保证数据在一定程度上是有效的。</p><p>为什么说是一定程度上的，因为还没有做完呢。</p><p>如果用户输入的数据是用于读取文件的，那么是不是应该还需要检查一下文件，当然，还会有访问控制和权限管理，这些放到之后在讨论。</p><h6 id="数据完整性"><a href="#数据完整性" class="headerlink" title="数据完整性"></a>数据完整性</h6><p>主要还需要说一下数据源，当数据的来源可信度较低的时候，都应该进行一些检查，确保数据没有被篡改。</p><ol><li>一致性检查</li><li>唯一性检查（如果有的话）</li><li>哈希校验</li><li>引用完整性</li></ol><p>当然，对于数据完整性的内容还是推荐自己去看看，这里的主要内容还是 OWASP Top 10。</p><p>我们完成了输入验证，一般都还需要执行验证后的操作。<br>比如，告知用户提交的数据不符合要求，应该修改数据以符合要求的条件。<br>在这一步骤中，我们需要注意的一个题外话，OWASP Top 10 并不是威胁最大的漏洞，威胁最大的可能是社工。<br>比如，攻击者并不想进行注入攻击，他只想知道这个手机号是否是这个程序、网站的注册用户。<br>如果我们程序对于手机号、密码错误返回的提示不同（用户不存在、密码错误），那么攻击者实际上就已经拿到了他想要的信息。<br>一般情况下，推荐后端只返回失败，不告知具体原因。</p><p>言归正传，我们检查了数据，但是没有做安全处理，我们还需要给数据进行消毒。</p><h6 id="消毒是指删除、替换数据。"><a href="#消毒是指删除、替换数据。" class="headerlink" title="消毒是指删除、替换数据。"></a>消毒是指删除、替换数据。</h6><ol><li>比如在 html 中将 &lt; 转意为 &lt;</li><li>剥离 html 标签</li><li>某些场景下（文件名）替换非 ASCII 字符</li><li>删除换行符、制表符、多余的空格</li><li>URL 路径清理</li></ol><p>注入攻击一直不怎么好防御，因为多数情况下是需要维护一个老系统，很多地方不能更改，动起来都碍手碍脚的。<br>在这种情况下，除了上述方法还可以通过其他手段来达到目的。</p><ol><li>权限控制，比如对于某张表只能查、对于另一张表没有查权限</li><li>白名单不好整，黑名单还是能使的</li><li>弄个蜜罐，想怎么玩就怎么玩</li></ol></article><p class="post-footer-info mb-0 pt-0">本文发表于&nbsp;<time datetime="2017-03-16T14:49:28.000Z" itemprop="datePublished">2017-03-16</time> , 最后修改于&nbsp;<time datetime="2019-09-20T08:49:28.000Z" itemprop="dateModified">2019-09-20</time></p><p class="post-footer-info mb-0 pt-2"><span class="post-tags-list mt-2"><a class="post-tags-list-item" href="/tags/OWASP/" rel="tag">#&nbsp;OWASP</a> <a class="post-tags-list-item" href="/tags/Injection/" rel="tag">#&nbsp;Injection</a> <a class="post-tags-list-item" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" rel="tag">#&nbsp;网络安全</a> <a class="post-tags-list-item" href="/tags/%E6%B3%A8%E5%85%A5/" rel="tag">#&nbsp;注入</a></span></p></div><div class="post-nav px-2 bg-gray"><ul class="pagination"><li class="page-item page-prev"><a href="/2017/owasp-2.html" rel="prev"><div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div><div class="page-item-subtitle">OWASP Top 10 - Authentication and Password Management</div></a></li></ul></div></div></div></div></div><footer class="text-center"><p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span id="copyright-year"></span> <a class="footer-copyright-a" href="https://01.946771200.xyz">Aoang's Blog</a></p><p class="footer-text mb-0"></p></footer><script>window.lazyLoadOptions={elements_selector:".lazyload",threshold:50},document.getElementById("copyright-year").textContent=(new Date).getFullYear()</script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@latest" async></script><script async>window.onload=function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src="/sw-register.js?v="+Date.now(),t.parentNode.insertBefore(e,t)}</script></body></html>