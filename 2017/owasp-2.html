<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="//946771200.xyz"><link rel="dns-prefetch" href="//cdn.jsdelivr.net"><link rel="dns-prefetch" href="//www.googletagmanager.com"><link rel="dns-prefetch" href="//www.google-analytics.com"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=5,viewport-fit=cover"><meta name="renderer" content="webkit"><title>OWASP Top 10 - Authentication and Password Management | Aoang&#39;s Blog</title><link rel="icon" type="image&#x2F;ico" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/apple-touch-icon.png"><link rel="icon" typt="image&#x2F;png" sizes="192x192" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/android-chrome-192x192.png"><link rel="icon" typt="image&#x2F;png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/favicon-32x32.png"><link rel="icon" typt="image&#x2F;png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/favicon-16x16.png"><link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/safari-pinned-tab.svg" color=""><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/spectre.css@latest"><style>body{background-color:#f8f9fa}a,a:visited{color:#0070ff}a:active,a:focus,a:hover{color:#0070ff;opacity:.75}#post-content a,#post-content a:focus,#post-content a:hover,#post-content a:visited{color:#005eb9;opacity:1}.post-entry .card-body a{color:#0070ff}.avatar{background:#444}.navbar-link,.navbar-link:visited,.timeline .timeline-item .timeline-icon.icon-lg{color:#0070ff}.navbar-link:hover{color:#0070ff;opacity:.8}#disqus-loadmore-button,#disqus-switch-to-direct,#disqus_click_btn,#search-input .btn{background:#727e96;border-color:#727e96;color:#fff}#post-toc a.post-toc-link,#post-toc a.post-toc-link:visited,.share-menu.menu .menu-item>a{color:#727e96}.share-menu.menu .menu-item>a:focus,.share-menu.menu .menu-item>a:hover,.share-menu.menu .menu-item>a:visited{color:#50596c;background:#f8f9fa;opacity:.85}</style><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/css/highlight/github.min.css" as="style" onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel="stylesheet" href="/css/highlight/github.min.css"></noscript><script>!function(n){"use strict";n.loadCSS||(n.loadCSS=function(){});var o=loadCSS.relpreload={};if(o.support=function(){var e;try{e=n.document.createElement("link").relList.supports("preload")}catch(t){e=!1}return function(){return e}}(),o.bindMediaToggle=function(t){var e=t.media||"all";function a(){t.addEventListener?t.removeEventListener("load",a):t.attachEvent&&t.detachEvent("onload",a),t.setAttribute("onload",null),t.media=e}t.addEventListener?t.addEventListener("load",a):t.attachEvent&&t.attachEvent("onload",a),setTimeout(function(){t.rel="stylesheet",t.media="only x"}),setTimeout(a,3e3)},o.poly=function(){if(!o.support())for(var t=n.document.getElementsByTagName("link"),e=0;e<t.length;e++){var a=t[e];"preload"!==a.rel||"style"!==a.getAttribute("as")||a.getAttribute("data-loadcss")||(a.setAttribute("data-loadcss",!0),o.bindMediaToggle(a))}},!o.support()){o.poly();var t=n.setInterval(o.poly,500);n.addEventListener?n.addEventListener("load",function(){o.poly(),n.clearInterval(t)}):n.attachEvent&&n.attachEvent("onload",function(){o.poly(),n.clearInterval(t)})}"undefined"!=typeof exports?exports.loadCSS=loadCSS:n.loadCSS=loadCSS}("undefined"!=typeof global?global:this)</script><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="Aoang's Blog"><meta name="msapplication-starturl" content="https://01.946771200.xyz"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Aoang's Blog"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="manifest" href="/manifest.json"><link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Aoang's Blog"><meta property="og:title" content="OWASP Top 10 - Authentication and Password Management | Aoang&#39;s Blog"><meta property="og:site_name" content="Aoang&#39;s Blog"><meta property="og:type" content="article"><meta property="og:url" content="https:&#x2F;&#x2F;01.946771200.xyz&#x2F;2017&#x2F;owasp-2.html"><meta property="og:locale" content="zh-CN"><meta name="description" content="很多古老的程序都存在一个普遍的问题——身份认证问题。如果有以下行为之一，就有可能存在这个问题。 1、允许弱密码（password 123456 admin）2、使用明文、加密或弱哈希管理密码3、允许暴力破解、自动攻击4、使用非安全连接进行认证5、使用 GET 请求进行认证6、不正确的失效策略 关于身份认证可以先从客户端说起。传统 Web 登录方式中，都会默认隐藏用户输入的密码，但是除此之外，应该默 - Aoang - Aoang&#39;s Blog"><meta name="keywords" content="OWASP, 网络安全, Authentication, Password, Session, Aoang, Aoangc, Blog, 博客, 网络, 安全"><meta property="article:published_time" content="2017-03-17T04:40:01.000Z"><meta property="article:modified_time" content="2019-09-20T08:50:00.000Z"><meta property="og:updated_time" content="2019-09-20T08:50:00.000Z"><meta property="article:author" content="Aoang"><meta property="article:tag" content="OWASP, 网络安全, Authentication, Password, Session, Aoang, Aoangc, Blog, 博客, 网络, 安全"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://01.946771200.xyz/2017/owasp-2.html"><meta name="generator" content="Hexo 4.0.0"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-130715850-2"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-130715850-2")</script><script type="application/ld+json">{
    "@context": "http://schema.org",
    "url": "https://01.946771200.xyz/2017/owasp-2.html",
    "@type": "BlogPosting",
    "logo": "https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/android-chrome-192x192.png",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://01.946771200.xyz/2017/owasp-2.html"
    },
    "headline": "OWASP Top 10 - Authentication and Password Management | Aoang&#39;s Blog",
    
    "image": {
        "@type": "ImageObject",
        "url": "https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/android-chrome-192x192.png"
    },
    
    "datePublished": "2017-03-17T04:40:01.000Z",
    "dateModified": "2019-09-20T08:50:00.000Z",
    "author": {
        "@type": "Person",
        "name": "Aoang",
        "image": {
            "@type": "ImageObject",
            "url": "https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/img.png"
        },
        "description": "岁月在电波中流淌，人生在音乐中升华"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Aoang&#39;s Blog",
        "logo": {
            "@type": "ImageObject",
            "url": "https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/favicon/android-chrome-192x192.png"
        }
    },
    
    "potentialAction": {
        "@type": "SearchAction",
        "target": "https://01.946771200.xyz/search.html?s={search_term_string}",
        "query-input": "required name=search_term_string"
    },
    
    "keywords": "OWASP, 网络安全, Authentication, Password, Session, Aoang, Aoangc, Blog, 博客, 网络, 安全",
    "description": "很多古老的程序都存在一个普遍的问题——身份认证问题。如果有以下行为之一，就有可能存在这个问题。 1、允许弱密码（password 123456 admin）2、使用明文、加密或弱哈希管理密码3、允许暴力破解、自动攻击4、使用非安全连接进行认证5、使用 GET 请求进行认证6、不正确的失效策略 关于身份认证可以先从客户端说起。传统 Web 登录方式中，都会默认隐藏用户输入的密码，但是除此之外，应该默 - Aoang - Aoang&#39;s Blog"
}</script><link rel="alternate" href="/atom.xml" title="Aoang's Blog" type="application/atom+xml"></head><body><header><h1 class="header-title text-center"><a href="/">Aoang&#39;s Blog</a></h1><p class="text-center header-slogan">岁月在电波中流淌，人生在音乐中升华</p><nav class="navbar-section text-center"><a href="/" class="navbar-link">首页</a> <a href="/archives/" class="navbar-link">归档</a> <a href="/search.html" class="navbar-link">搜索</a> <a href="/project.html" class="navbar-link">项目</a> <a href="/wiki/" class="navbar-link">文档</a> <a href="/links.html" class="navbar-link">友链</a> <a href="/about.html" class="navbar-link">关于</a></nav></header><div class="post-container"><div id="post-card" class="card"><div class="card-item-container"><div class="card-inner-cell"><div class="card-header"><h1 class="card-title h3 mb-2">OWASP Top 10 - Authentication and Password Management</h1><div class="post-header-info"><p class="post-header-info-left text-gray"><img class="author-thumb lazyload" data-src="https://cdn.jsdelivr.net/gh/Aoang/Aoang.github.io@master/img/img.png" src="/img/suka-lazyload.gif" alt="Aoang's Avatar"> <span>2017-03-17</span></p><div class="post-header-info-right"></div></div></div><div class="card-body"><article id="post-content"><p>很多古老的程序都存在一个普遍的问题——身份认证问题。如果有以下行为之一，就有可能存在这个问题。</p><p>1、允许弱密码（password 123456 admin）<br>2、使用明文、加密或弱哈希管理密码<br>3、允许暴力破解、自动攻击<br>4、使用非安全连接进行认证<br>5、使用 GET 请求进行认证<br>6、不正确的失效策略</p><p>关于身份认证可以先从客户端说起。<br>传统 Web 登录方式中，都会默认隐藏用户输入的密码，但是除此之外，应该默认禁用记住会话、记住密码这些功能。</p><p>用户使用的电脑并非一定是自己的、安全的，默认禁用这些功能对提升安全性的作用是很大的。</p><p>做到了这一点，应该在考虑一下后端的问题，用户的会话失效策略应该是怎么样的。在各种使用场景中，主动注销可能并不符合用户的使用习惯。</p><p>会话失效策略定义的过于严格的话，会导致用户在正常使用过程中会话失效，导致用户使用体验变差。对于这个问题，应当结合场景制定合适的会话策略。</p><p>一般情况下，必须确保用于生成会话标识符的算法足够随机，防止被爆破。</p><ul><li>cookies 的过期时间应该足够合适</li><li>会话标识符不会在 URL 中公开，它应该仅位于 HTTP cookie 中</li><li>会话数据也必须受到保护，防止服务器的其他用户未经授权的访问</li><li>如果有 HTTP 重定向到 HTTPS，那应该特别注意 MITM 攻击嗅探</li><li>如果有高度敏感的操作，那么可以考虑按照请求生成 token，保持 token 足够随机，且长度足够安全</li></ul><p>现在越来越多的网站开始使用甚至强制使用加密连接（HTTPS）了，而对于 Web 应用而言这也是必须的了。<br>如果数据传输不通过 TLS/SSL 进行，可能会因为中间人攻击导致用户会话的相关信息泄露，甚至服务器也会遭受入侵。</p><p>在发送认证请求的时候，尽管在 HTTPS 下，通过 GET 请求和 POST 是一样安全的，但是还是应该使用 PSOT 请求。<br>因为在一般的 HTTP 服务器（Nginx Apache）中，会将请求的 URL 写入日志。</p><p>在之前的文章中提到过一点，如果用户身份验证错误，程序不要返回过于详细的信息，使用“无效的用户名或密码”来代替“用户名不存在”、“密码错误”。<br>因为提示用户名不存在会泄露一个用户是否存在，而密码错误这个提示会暴露后端的工作模式，先验证用户名，然后比较密码。</p><p>如果可能的话，成功登录之后，应该告知用户最近一次成功、失败的访问记录，以便用户检查可疑活动。<br>如果对于安全性有更高的要求的话，应该采取一定的密码策略。</p><p>例如，我们应该强制用户不得使用弱密码。<br>可以要求用户的密码至少包括大写字母、小写字母、数字、特殊符号中的三种甚至四种，要求用户的密码长度为八位甚至十六位以上。<br>还可以要求用户间隔一段时间之后强制更改密码，并不得使用过去使用过的密码。</p><p>在这个方面，Microsoft 做的很强，它除了上述策略，还有黑名单策略（禁止使用网络上公布的常见的弱密码），密码不得包含用户名。<br>但是在提示用户安全这一块，Google 可能做的更好，更加人性化，因为上面很容易就能看到上次更改密码的时间、提示的风险等等。</p><p>不过在日志这一块上，GitHub 做的非常详细。<br>大家感兴趣的话，可以分别去体验一下。</p><p>除了这些密码策略，程序应该要做到防止被爆破。<br>比如，登录失败次数过多，程序应当限制账号登录一段时间，但是这个时间得控制好，不然的话会成为别人拒绝式攻击服务的手段之一，导致用户无止境的被冻结，无法正常使用。<br>还有密码应该至少存在一段时间之后才能再次更改，这样可以一定程度上的防止密码重用攻击。<br>对于用户重置密码时，发送重置链接、或者验证码的时候，这样的敏感信息应该具有较短的到期时间。</p><p>最后说下密码的储存策略，先说一句密码学中的格言，永远不要自己设计加密方案。</p><p>你可以自动设计加密方案，但是如果你不是这个领域内的专家，或者没有经过其他专家对方案进行分析，那你的方案可能会存在严重的安全性错误。<br>一个公开的加密方案，能被所有人进行审查分析，一个方案只有遭到广泛的攻击之后才是安全的。</p><p>密码学也存在很多安全性问题，对于计算机科学的安全性问题都缺乏了解，对于其他技术就更谈不上了。<br>在存储密码，Golang 已经有现成的哈希算法可以使用了 <code>bcrypt</code> <code>scrypt</code> <code>PDKDF2</code> <code>Argon2</code>，而不应该使用那些不够安全的哈希算法 <code>MD5</code> <code>SHA-1</code>。</p><p>哈希和加密是两种不同的概念，拥有不同的用途。<br>哈希是将目标文本转换成具有相同长度的、不可逆的字符串，而加密将目标文本转换成具有不同长度的、可逆的密文。</p><p>在储存密码中，除了使用哈希，还可以使用加密，区别在哪里呢。<br>如果数据仅仅用于比较、验证，不需要还原成明文，那就使用哈希，反之则使用加密。<br>一般情况下，储存密码都会使用哈希，但是一些特殊场景下，会需要还原成明文，才需要使用加密。</p><p>一般情况下，服务器被入侵数据泄露之后，如果密码是明文，那么用户的信息就直接泄露了，但是一般情况都是使用哈希算法对密码进行处理。<br>起初，对于简单的密码和简单的密码系统，可以通过字典穷举进行破解，而之后出现了彩虹表，所以对于重要的场景不要使用弱哈希算法。</p></article><p class="post-footer-info mb-0 pt-0">本文发表于&nbsp;<time datetime="2017-03-17T04:40:01.000Z" itemprop="datePublished">2017-03-17</time> , 最后修改于&nbsp;<time datetime="2019-09-20T08:50:00.000Z" itemprop="dateModified">2019-09-20</time></p><p class="post-footer-info mb-0 pt-2"><span class="post-tags-list mt-2"><a class="post-tags-list-item" href="/tags/OWASP/" rel="tag">#&nbsp;OWASP</a> <a class="post-tags-list-item" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" rel="tag">#&nbsp;网络安全</a> <a class="post-tags-list-item" href="/tags/Authentication/" rel="tag">#&nbsp;Authentication</a> <a class="post-tags-list-item" href="/tags/Password/" rel="tag">#&nbsp;Password</a> <a class="post-tags-list-item" href="/tags/Session/" rel="tag">#&nbsp;Session</a></span></p></div><div class="post-nav px-2 bg-gray"><ul class="pagination"><li class="page-item page-prev"><a href="/2017/http.html" rel="prev"><div class="page-item-title"><i class="icon icon-back" aria-hidden="true"></i></div><div class="page-item-subtitle">简述 HTTP</div></a></li><li class="page-item page-next"><a href="/2017/owasp-1.html" rel="next"><div class="page-item-title"><i class="icon icon-forward" aria-hidden="true"></i></div><div class="page-item-subtitle">OWASP Top 10 - Injection</div></a></li></ul></div></div></div></div></div><footer class="text-center"><p class="footer-copyright mb-0">Copyright&nbsp;©&nbsp;<span id="copyright-year"></span> <a class="footer-copyright-a" href="https://01.946771200.xyz">Aoang's Blog</a></p><p class="footer-text mb-0"></p></footer><script>window.lazyLoadOptions={elements_selector:".lazyload",threshold:50},document.getElementById("copyright-year").textContent=(new Date).getFullYear()</script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@latest" async></script><script async>window.onload=function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.type="text/javascript",e.async=!0,e.src="/sw-register.js?v="+Date.now(),t.parentNode.insertBefore(e,t)}</script></body></html>